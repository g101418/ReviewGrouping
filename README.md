# 职称评审分组程序



该程序是用来在职称评审中，按照规定的约束随机生成专家分组情况的小程序，有 Python 版本和有图形界面的前端版本。



## 职称评审分组约束条件

输入：

> - 分组数（组长数）$N$
> - 组员数 $M$
> - $N$ 个组长和 $M$ 个组员（共 $N+M$ 人）的来自省份信息和是否为外部专家信息
> - $N$ 个组的回避省份要求

输出：

> - $N$ 个组的分组情况

约束条件：

> 1. 每个组都要有一个组长（有且只有一个）。
> 2. 每个组都**至少**有一个外部专家。
> 3. 每个组的组长、组员均要满足**回避条件**（人员的省份不能出现在所在组的回避省份列表中）。
> 4. 每个组的人数要基本均匀（最高的和最低的人数差最大为 $1$）。

**例子**：

输入：
```shell
5
22

孙某某 总局
黄某人 北京
焦某人 山西
殷专家 江苏
张三丰 海南 外部

钱大师 浙江 外部
田专家 北京 
牛专家 上海 外部
王教授 上海 
魏专家 总局 
张处长 北京 外部
李科长 宁夏 
陆主任 广西 
吴院长 福建 外部
牟大夫 辽宁 
王某 大连 
徐主任 山东 
郭科长 天津 
宋得 内蒙 
王五 大连 
lily 宁波 
张乔 安徽 
荆乐 北京 
张大伟 吉林 
betty 厦门 
何大 北京 外部
新得 陕西 外部

河北 吉林 陕西 宁夏 重庆
浙江 厦门 山东 江苏 青岛
北京 上海 深圳 广东 宁波 河南 
江西 湖南 大连 海南 云南
安徽 四川 西藏 内蒙
```


输出：

```shell
第1组：组长：张三丰（外部）; 组员：钱大师（外部）, 郭科长, 王教授, 荆乐, lily
第2组：组长：孙某某; 组员：吴院长（外部）, 何大（外部）, 魏专家, 李科长, 宋得
第3组：组长：殷专家; 组员：新得（外部）, betty, 陆主任, 徐主任
第4组：组长：黄某人; 组员：张处长（外部）, 田专家, 牟大夫, 张乔
第5组：组长：焦某人; 组员：牛专家（外部）, 王五, 王某, 张大伟
```


------



## 💡 实现原理：基于约束的回溯算法



本项目所解决的专家分组问题，是一个典型的**带约束条件的人员分配问题 (Constraint Satisfaction Problem)**，我们采用**回溯算法 (Backtracking Algorithm)** 来求解。

为了高效且稳定地找到满足所有严格约束的解，程序采用了**“先紧后松”**的分步分配策略，并结合动态计算的分配限制。



### 1. 核心算法：分阶段回溯法



分配过程被拆分为三个关键阶段，每个阶段都使用回溯算法来尝试将人员分配到 $N$ 个小组中。回溯算法确保了如果当前的选择导致后续任何约束无法满足，程序会立即**回退 (Backtrack)** 到上一个选择点，尝试其他的分配方案。



#### 🔹 阶段一：分配组长 (Leaders)



- **目标：** 为 $N$ 个组分配唯一的组长。
- **主要约束：** 必须满足**回避条件**。



#### 🔹 阶段二：分配外部专家组员 (External Experts)



- **目标：** 分配所有外部专家组员。
- **主要约束：** 优先确保满足**“每个组至少有一个外部专家”**的条件，并严格控制每组的**外部专家数量上限**，以保证外部专家资源的均匀分配。



#### 🔹 阶段三：分配普通组员 (General Members)



- **目标：** 分配所有剩余的普通组员。
- **主要约束：** 保证最终的**人数均衡**。



### 2. 确保均衡性的约束细节



为了满足约束 4（人数均匀），以及更好地满足约束 2（外部专家均匀），程序在 **`init`** 阶段会动态计算一组严格的上下限：

| **约束类型**         | **计算方式**                            | **目的**                                                     |
| -------------------- | --------------------------------------- | ------------------------------------------------------------ |
| **每组人数上限**     | $\lceil (N+M) / N \rceil$               | 确保人数不会过度集中。                                       |
| **每组人数下限**     | $\lfloor (N+M) / N \rfloor$             | 确保人数不会过少。                                           |
| **每组外部专家上限** | $\lceil \text{总外部专家数} / N \rceil$ | 确保外部专家分布均匀。                                       |
| **“触顶”组数限制**   | $(N+M) \pmod{N}$                        | 严格限制最多只能有 $\text{余数}$ 个组的人数达到上限（保证最高的和最低的差最大为 $1$）。 |

在回溯过程中，**动态约束检查**会随时利用这些计算出的上限和限制（如“触顶”限制），一旦发现分配给某个组会导致该组或整个分配结果超限，则立即停止尝试并回退。



### X. 通过随机生成分组



还有一种方法：将组长、外部专家、组员，随机分组，然后通过check()反复校验，直到生成某个分组为止，该方法时间不可控。



⚠️ 该README由AI辅助生成，Python代码由AI添加注释，html由AI根据Python代码生成

